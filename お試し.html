<!-- Typing game -->
<div id="typing-start">
  <p>è©¦ä½œè©¦ä½œè©¦ä½œè©¦ä½œè©¦ä½œè©¦ä½œè©¦ä½œè©¦ä½œè©¦ä½œè©¦ä½œè©¦ä½œè©¦ä½œ</p>
  <button id="open-button" type="button">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
  <p class="note">â€»ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚µã‚¤ã‚ºã®éƒ½åˆä¸Šã€è§£åƒåº¦(æ¨ª)748pxä»¥ä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã§ã®ãƒ—ãƒ¬ã‚¤ã‚’æ¨å¥¨ã—ã¾ã™ã€‚</p>
  <noscript>
    <p class="msg">æœ¬ã‚²ãƒ¼ãƒ ã‚’ãƒ—ãƒ¬ã‚¤ã™ã‚‹ã«ã¯JavaScriptã‚’æœ‰åŠ¹åŒ–ã—ã¦ãã ã•ã„ã€‚</p>
  </noscript>
</div>
<div id="game-screen">
  <div id="game-header">
    <div class="description">ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚²ãƒ¼ãƒ ã‚‚ã©ã</div>
    <button id="close-button1" type="button">é–‰ã˜ã‚‹</button>
  </div>
  <div id="game-banner">
    <a href="https://e-inkan.com/data/21-na/nakamura/nakamura.html" rel="noopener" target="_blank">
      <img alt="ãƒãƒŠãƒ¼ç”»åƒ" width="728" height="90" src="https://e-inkan.com/data/21-na/nakamura/svg-data.svgz"/>
    </a>
  </div>
  <div id="game-body">
    <div id="game-view1">
      <div id="game-title">æ‰“ã¡ã«ãã„ã‚„ã¤</div>
      <div id="game-explain"></div>
      <button id="start-button" type="button">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
      <div id="game-func">
        <span>ãƒ­ãƒ¼ãƒå­—è¡¨ç¤º(R)</span>
        <div class="switch-btn">
          <button class="on-btn btn show" type="button">ON</button>
          <button class="off-btn btn" type="button">OFF</button>
        </div>
        <span>ã‹ãªè¡¨ç¤º(K)</span>
        <div class="switch-btn">
          <button class="on-btn btn show" type="button">ON</button>
          <button class="off-btn btn" type="button">OFF</button>
        </div>
        <span>ã‚­ãƒ¼ã‚¬ã‚¤ãƒ‰(G)</span>
        <div class="switch-btn">
          <button class="on-btn btn show" type="button">ON</button>
          <button class="off-btn btn" type="button">OFF</button>
        </div>
        <span>WPMè¡¨ç¤º(W)</span>
        <div class="switch-btn">
          <button class="on-btn btn show" type="button">ON</button>
          <button class="off-btn btn" type="button">OFF</button>
        </div>
        <span>ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒãƒ¼(S)</span>
        <div class="switch-btn">
          <button class="on-btn btn show" type="button">ON</button>
          <button class="off-btn btn" type="button">OFF</button>
        </div>
      </div>
    </div>
    <div id="game-view2">
      <div id="text-container">
        <div id="miss-type-screen"></div>
        <div id="start-msg">
          <p>æ—¥æœ¬èªå…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ•ã«ã—ã¦ãã ã•ã„</p>
          <p><em>ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ã§é–‹å§‹</em></p>
          <p>ï¼ˆçµ‚äº†ã¯Escã‚­ãƒ¼ã§ã™ï¼‰</p>
        </div>
        <div id="example"></div>
        <div id="kana"></div>
        <div id="sentence"></div>
        <div id="progress-bar"></div>
        <div id="current-wpm"></div>
        <div id="speed-bar">
          <div class="cover"></div>
        </div>
      </div>
      <div id="virtual-keyboard">
        <div class="deco_key1"></div>
        <div class="key_1">1</div>
        <div class="key_2">2</div>
        <div class="key_3">3</div>
        <div class="key_4">4</div>
        <div class="key_5">5</div>
        <div class="key_6">6</div>
        <div class="key_7">7</div>
        <div class="key_8">8</div>
        <div class="key_9">9</div>
        <div class="key_0">0</div>
        <div class="key_hyphen">-</div>
        <div class="deco_key2"></div>
        <div class="deco_key3"></div>
        <div class="deco_key4"></div>
        <div class="deco_key5"></div>
        <div class="key_q">Q</div>
        <div class="key_w">W</div>
        <div class="key_e">E</div>
        <div class="key_r">R</div>
        <div class="key_t">T</div>
        <div class="key_y">Y</div>
        <div class="key_u">U</div>
        <div class="key_i">I</div>
        <div class="key_o">O</div>
        <div class="key_p">P</div>
        <div class="key_atmark">@</div>
        <div class="deco_key6"></div>
        <div class="key_Enter"></div>
        <div class="deco_key7"></div>
        <div class="key_a">A</div>
        <div class="key_s">S</div>
        <div class="key_d">D</div>
        <div class="key_f">F</div>
        <div class="key_g">G</div>
        <div class="key_h">H</div>
        <div class="key_j">J</div>
        <div class="key_k">K</div>
        <div class="key_l">L</div>
        <div class="key_semicolon">;</div>
        <div class="key_colon">:</div>
        <div class="deco_key8"></div>
        <div class="key_lShift">shift</div>
        <div class="key_z">Z</div>
        <div class="key_x">X</div>
        <div class="key_c">C</div>
        <div class="key_v">V</div>
        <div class="key_b">B</div>
        <div class="key_n">N</div>
        <div class="key_m">M</div>
        <div class="key_comma">,</div>
        <div class="key_period">.</div>
        <div class="key_slash">/</div>
        <div class="deco_key9"></div>
        <div class="key_rShift">shift</div>
        <div class="deco_key10"></div>
        <div class="deco_key11"></div>
        <div class="deco_key12"></div>
        <div class="deco_key13"></div>
        <div class="key_space">space</div>
        <div class="deco_key14"></div>
        <div class="deco_key15"></div>
        <div class="deco_key16"></div>
        <div class="deco_key17"></div>
        <div class="deco_key18"></div>
      </div>
    </div>
    <div id="game-result">
      <div id="current-result">
        <div class="result-title">ä»Šå›ã®ã‚¿ã‚¤ãƒ”ãƒ³ã‚°çµæœ</div>
        <div id="example-list"></div>
        <div class="result-data"></div>
      </div>
      <div id="prev-result">
        <div class="result-title">å‰å›ã®çµæœ</div>
        <div class="result-data"></div>
      </div>
      <div id="result-comment">
        <div class="container">---</div>
      </div>
      <div id="btn-area">
        <button id="replay-button" class="btn" type="button">ã‚‚ã†1å›</button>
        <button id="close-button2" class="btn" type="button">é–‰ã˜ã‚‹</button>
      </div>
    </div>
  </div>
</div>
<script>
/*
e-typing-like typing game v1.1 created with passion by Fuma(@fuma_it)
Have fun :)
*/
(function(window, document) {
  const overlay = document.createElement('div');
  overlay.id = 'game-overlay';
  const game = document.getElementById('game-screen');
  const button1 = document.getElementById('close-button1');
  const button2 = document.getElementById('open-button')
  const button3 = document.getElementById('start-button');
  const button4 = document.getElementById('replay-button');
  const button5 = document.getElementById('close-button2');
  const view1 = document.getElementById('game-view1');
  const gameFunc = document.getElementById('game-func');
  const onBtns = gameFunc.querySelectorAll('.on-btn');
  const offBtns = gameFunc.querySelectorAll('.off-btn');
  const view2 = document.getElementById('game-view2');
  const result = document.getElementById('game-result');
  const mScreen = document.getElementById('miss-type-screen');
  const startMsg = document.getElementById('start-msg');
  const example = document.getElementById('example');
  const kana = document.getElementById('kana');
  const sentence = document.getElementById('sentence');
  const progress = document.getElementById('progress-bar');
  const keyboard = document.getElementById('virtual-keyboard');
  const space = keyboard.querySelector('.key_space');
  let wordJP1 = ['ãƒ‡ãƒ‡ãƒ‡å¤§ç‹', 'å¹ãå‡ºã‚‹', 'å†¬æœ¨', 'ç½ã„', 'ğŸ¥º', 'é¢ç™½ããªã„', 'ä¸­æ‘', 'ä»–å›½ã¨å¯¾ç­‰é–¢ä¿‚ã«ç«‹ãŸã†ã¨ã™ã‚‹å„å›½ã®è²¬å‹™ã§ã‚ã‚‹ã¨ä¿¡ãšã‚‹']; // è¡¨ç¤ºæ–‡ç« 
  let wordJP2 = ['ã§ã§ã§ã ã„ãŠã†', 'ãµãã§ã‚‹', 'ãµã‚†ã', 'ã‚ã–ã‚ã„', 'ã´ãˆã‚“', 'ãŠã‚‚ã—ã‚ããªã„', 'ãªã‹ã‚€ã‚‰', 'ãŸã“ãã¨ãŸã„ã¨ã†ã‹ã‚“ã‘ã„ã«ãŸãŸã†ã¨ã™ã‚‹ã‹ã£ã“ãã®ã›ãã‚€ã§ã‚ã‚‹ã¨ã—ã‚“ãšã‚‹']; // ã²ã‚‰ãŒãªæ–‡ç« 
  let wordRs; // ãƒ­ãƒ¼ãƒå­—ãƒ‡ãƒ¼ã‚¿1
  let wordR; // ãƒ­ãƒ¼ãƒå­—ãƒ‡ãƒ¼ã‚¿2
  let record; // ã‚¿ã‚¤ãƒ—ã—ãŸæ–‡ç« ã®è¨˜éŒ²
  let recordHTML;
  let recordM = []; // ãƒŸã‚¹ã—ãŸæ–‡ç« ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
  let weakKeys; // è‹¦æ‰‹ã‚­ãƒ¼æ ¼ç´ç”¨
  let gameData = []; // ã‚¿ã‚¤ãƒ”ãƒ³ã‚°çµæœ
  let backup1 = [];
  let backup2 = [];
  let isFirst = true;
  let isOpen = false;
  let startFlag = false;
  let sWait = false;
  let playing = false;
  let nFlag = false;
  let missFlag = false;
  let isStopped = false;
  let moPlay = false;
  let maxNum = 10; // å‡ºé¡Œæ•°ã®ä¸Šé™
  let random = true; // ãƒ©ãƒ³ãƒ€ãƒ å‡ºé¡Œ
  let resCmt = true; // çµæœç”»é¢ã®ã‚³ãƒ¡ãƒ³ãƒˆ
  let flagR = true; // ãƒ­ãƒ¼ãƒå­—è¡¨ç¤º
  let flagK = true; // ã‹ãªè¡¨ç¤º
  let flagG = true; // ã‚­ãƒ¼ã‚¬ã‚¤ãƒ‰
  let flagW = true; // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®WPM
  let flagS = true; // ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒãƒ¼
  let flags = [flagR, flagK, flagG, flagW, flagS];
  let ridx, limit, begin, count, idx1, idx2, pattern, temp, correct, miss;
  let over1, over2, over3, left1, left2, left3;

  // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚ªãƒ¼ãƒ—ãƒ³
  function open() {
    isOpen = true;
    overlay.style.display = 'block';
    overlay.style.width = document.body.clientWidth + 'px';
    overlay.style.height = document.body.clientHeight + 'px';
    game.style.display = 'block';
    game.style.top = window.pageYOffset + window.innerHeight / 2 - game.clientHeight / 2 + 'px';
    game.style.left = window.innerWidth / 2 - game.clientWidth / 2 + 'px';

    if (isFirst) {
      document.body.appendChild(overlay);
      document.body.appendChild(game);
      document.head.insertAdjacentHTML('beforeend', '<style id="custom-css"></style>');
    } else {
      view1.style.display = 'table-cell';
      view2.style.display = 'none';
      result.style.display = 'none';
    }

    let fData = localStorage.getItem('flags');
    if (fData) {
      fData = JSON.parse(fData);
      for (let i = 0; i < fData.length; i++) {
        if (!fData[i]) onBtns[i].click();
      }
    }

    isFirst = false;
  }

  // ã‚¹ã‚¿ãƒ¼ãƒˆå‡¦ç†
  function start() {
    view1.style.display = 'none';
    view2.style.display = 'block';
    startMsg.style.display = 'block';

    startFlag = true;
    sWait = true;
    space.classList.add('active');

    flagR = flags[0];
    flagK = flags[1];
    flagG = flags[2];
    flagW = flags[3];
    flagS = flags[4];
    flags = [flagR, flagK, flagG, flagW, flagS];
    localStorage.setItem('flags', JSON.stringify(flags));
  }

  // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³å‡¦ç†
  function ready() {
    startMsg.style.display = 'none';
    const count = document.createElement('div');
    count.id = 'countdown';
    startMsg.after(count);
    let readyTime = 3;
    count.innerHTML = readyTime;
    const readyTimer = setInterval(() => {
      readyTime--;
      if (readyTime == 0) {
        clearInterval(readyTimer);
        count.remove();
        gameInit();
      }
      count.innerHTML = readyTime;
    }, 1000);
  }

  // ã‚²ãƒ¼ãƒ é–‹å§‹å‡¦ç†
  function gameInit() {
    count = 0;
    idx1 = 0;
    idx2 = 0;
    temp = '';
    correct = 0;
    miss = 0;
    ridx = [];
    record = [];
    recordHTML = '';
    weakKeys = [];
    nFlag = false;
    missFlag = false;

    if (moPlay) {
      let missJP1 = [];
      let missJP2 = [];
      for (let i = 0; i < recordM.length; i++) {
        missJP1.push(wordJP1[recordM[i]]);
        missJP2.push(wordJP2[recordM[i]]);
      }
      if (backup1.length == 0) {
        backup1 = [...wordJP1];
        backup2 = [...wordJP2];
      }
      wordJP1 = missJP1;
      wordJP2 = missJP2;
    } else {
      if (backup1.length > 0) {
        wordJP1 = [...backup1];
        wordJP2 = [...backup2];
        backup1 = [];
        backup2 = [];
      }
    }
    recordM = [];

    let idx;
    let a = [...Array(wordJP2.length).keys()];
    if (random) {
      while (a.length > 0) {
        idx = Math.floor(Math.random() * a.length);
        ridx.push(a[idx]);
        a.splice(idx, 1);
      }
    } else {
      ridx = a;
    }

    wordRs = [];
    for (let i = 0; i < wordJP2.length; i++) {
      wordRs.push(kanaToRoman(wordJP2[i]));
    }
    limit = (maxNum < wordJP2.length) ? maxNum : wordJP2.length;
    playing = true;
    begin = new Date();
    wordSet();

    let style = '';
    if (!flagR) {
      style += '#sentence span:not(.typed) {opacity: 0;}';
    }
    if (!flagK) {
      style += '#kana > div {opacity: 0;}';
    }
    document.getElementById('custom-css').innerHTML = style;

    if (flagW) {
      const cWPM = document.getElementById('current-wpm');
      cWPM.style.display = 'block';
      cWPM.innerHTML = 'WPM: 0.00';
      const id = setInterval(() => {
        let time = new Date() - begin;
        let speed = correct / time * 60 * 1000;
        if (playing) {
          cWPM.innerHTML = 'WPM: ' + speed.toFixed(2);
        } else {
          clearInterval(id);
          cWPM.innerHTML = '';
          cWPM.style.display = 'none';
        }
      }, 100);
    }

    if (flagS) {
      const speedBar = document.getElementById('speed-bar');
      const cover = speedBar.querySelector('.cover');
      speedBar.style.display = 'block';
      cover.style.transform = 'none';
      const id = setInterval(() => {
        let time = new Date() - begin;
        let speed = correct / time * 60 * 1000;
        if (playing) {
          let scale = 1 - speed / 700;
          cover.style.transform = 'scaleX(' + scale + ')';
        } else {
          clearInterval(id);
          cover.style.transform = 'none';
          speedBar.style.display = 'none';
        }
      }, 100);
    }
  }

  // ã‚¿ã‚¤ãƒ”ãƒ³ã‚°æ–‡ç« ã‚»ãƒƒãƒˆ
  function wordSet() {
    if (count == limit) {
      finish();
    } else {
      example.innerHTML = '<div>' + wordJP1[ridx[count]] + '</div>';
      kana.innerHTML = '<div>' + wordJP2[ridx[count]] + '</div>';
      wordR = wordRs[ridx[count]];
      let html;
      html = '<div><span class="typed"></span><span>';
      for (let i = 0; i < wordR.length; i++) {
        html += wordR[i][0];
      }
      html += '</span></div>';
      sentence.innerHTML = html;
      pattern = new Array(wordR.length).fill(0);
      if (count > 0) {
        progress.style.transform = 'scaleX(' + (1 - count / limit) + ')';
      }
      count++;
      selActive();
    }
  }

  // ã‚²ãƒ¼ãƒ çµ‚äº†
  function finish() {
    let time = new Date() - begin;
    playing = false;

    const active = keyboard.querySelector('.active');
    if (active) active.classList.remove('active');

    view2.style.display = 'none';
    result.style.display = 'block';
    example.innerHTML = '';
    kana.innerHTML = '';
    sentence.innerHTML = '';
    progress.style.transform = 'none';

    const resList = document.getElementById('example-list');
    const resData = result.querySelectorAll('.result-data');

    let speed, accuracy, score;
    speed = correct / time * 60 * 1000;
    accuracy = correct / (correct + miss);
    score = isStopped ? '-' : Math.floor(speed * accuracy ** 3);

    let html;
    html = '<ul>';
    for (let i = 0; i < limit; i++) {
      html += '<li>';
      html += '<div class="example">' + wordJP1[ridx[i]] + '</div>';
      html += '<div class="sentence">';
      wordR = wordRs[ridx[i]];
      if (isStopped) {
        if (record[i]) {
          html += record[i];
        } else {
          if (!!recordHTML) {
            html += recordHTML;
            recordHTML = '';
            if (missFlag) {
              weakKeys.push(wordR[idx1][pattern[idx1]][idx2]);
              html += '<span class="miss">' + wordR[idx1][pattern[idx1]][idx2] + '</span>';
              missFlag = false;
            } else {
              html += wordR[idx1][pattern[idx1]][idx2];
            }
            for (let j = idx2 + 1; j < wordR[idx1][pattern[idx1]].length; j++) {
              html += wordR[idx1][pattern[idx1]][j];
            }
            for (let j = idx1 + 1; j < wordR.length; j++) {
              html += wordR[j][0];
            }
          } else {
            if (missFlag) {
              weakKeys.push(wordR[0][0][0]);
              html += '<span class="miss">' + wordR[0][0][0] + '</span>';
              for (let j = 1; j < wordR[0][0].length; j++) {
                html += wordR[0][0][j];
              }
              for (let j = 1; j < wordR.length; j++) {
                html += wordR[j][0];
              }
              missFlag = false;
            } else {
              for (let j = 0; j < wordR.length; j++) {
                html += wordR[j][0];
              }
            }
          }
        }
      } else {
        html += record[i];
      }
      html += '</div></li>';
    }
    html += '</ul>';
    resList.innerHTML = html;

    if (gameData.length > 0) {
      html = '<ul>'
      html += '<li><div class="data">' + gameData[0] + '</div></li>';
      html += '<li><div class="data">' + gameData[1] + '</div></li>';
      html += '<li><div class="data">' + gameData[2] + '</div></li>';
      html += '<li><div class="data">' + gameData[3] + '</div></li>';
      html += '<li><div class="data">' + gameData[4] + '</div></li>';
      html += '<li><div class="data">' + gameData[5] + '</div></li>';
      html += '<li><div class="data">' + gameData[6] + '</div></li>';
      html += '<li><div class="data">' + gameData[7] + '</div></li>';
      html += '</ul>';
    } else {
      html = '<ul>'
      html += '<li><div class="data">-</div></li>';
      html += '<li><div class="data">-</div></li>';
      html += '<li><div class="data">-</div></li>';
      html += '<li><div class="data">-</div></li>';
      html += '<li><div class="data">-</div></li>';
      html += '<li><div class="data">-</div></li>';
      html += '<li><div class="data">-</div></li>';
      html += '<li><div class="data">-</div></li>';
      html += '</ul>';
    }
    resData[1].innerHTML = html;

    html = '<ul>';
    html += '<li><div class="title">ã‚¹ã‚³ã‚¢</div><div class="data">' + score + '</div></li>';
    html += '<li><div class="title">ãƒ¬ãƒ™ãƒ«</div><div class="data">' + getLevel(score) +'</div></li>';
    html += '<li><div class="title">å…¥åŠ›æ™‚é–“</div><div class="data">' + convTime(time) + '</div></li>';
    html += '<li><div class="title">å…¥åŠ›æ–‡å­—æ•°</div><div class="data">' + correct + '</div></li>';
    html += '<li><div class="title">ãƒŸã‚¹å…¥åŠ›æ•°</div><div class="data">' + miss + '</div></li>';
    html += '<li><div class="title">WPM</div><div class="data">' + convStr(speed.toFixed(2)) + '</div></li>';
    html += '<li><div class="title">æ­£ç¢ºç‡</div><div class="data">' + convStr((accuracy * 100).toFixed(2)) + '%</div></li>';
    html += '<li><div class="title">è‹¦æ‰‹ã‚­ãƒ¼</div><div class="data">' + getWeaks(weakKeys) + '</div></li>';
    html += '</ul>';
    resData[0].innerHTML = html;
    gameData = [score, getLevel(score), convTime(time), correct, miss, convStr(speed.toFixed(2)), convStr((accuracy * 100).toFixed(2)) + '%', getWeaks(weakKeys)];

    if (resCmt) {
      const resComment = document.getElementById('result-comment');
      const container = resComment.querySelector('.container');
      const comment1 = 'ãƒãƒ¼ãƒŸã‚¹ã§ã—ãŸã€ã£ã‚‡ãƒï¼';
      const comment2 = 'æƒœã—ã„ï¼ã‚ã¨1æ–‡å­—ã€‚æ¬¡ã¯ãƒŸã‚¹0ã‚’ç‹™ã„ã¾ã—ã‚‡ã†ã€‚';
      const comments = ['ãƒ©ãƒ³ã‚­ãƒ³ã‚°æ©Ÿèƒ½ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ğŸ¥º', 'ğŸ¥ºãƒ©ãƒ³ã‚­ãƒ³ã‚°æ©Ÿèƒ½ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ğŸ¥º'];
      if (!isStopped) {
        if (miss == 0) {
          container.innerHTML = comment1;
        } else if (miss == 1) {
          container.innerHTML = comment2;
        } else {
          let idx = Math.floor(Math.random() * comments.length);
          container.innerHTML = comments[idx];
        }
      } else {
        container.innerHTML = '---';
      }
    }

    isStopped = false;

    const moBtn = document.getElementById('miss-only-button');
    if (recordM.length > 0) {
      if (!moBtn) {
        const button6 = document.createElement('button');
        button6.type = 'button';
        button6.id = 'miss-only-button';
        button6.classList.add('btn');
        button6.innerHTML = 'ãƒŸã‚¹ã ã‘';
        button6.addEventListener('click', () => {
          moPlay = true;
          sWait = true;
          result.style.display = 'none';
          view2.style.display = 'block';
          startMsg.style.display = 'block';
          space.classList.add('active');
        });
        const btnArea = document.getElementById('btn-area');
        btnArea.appendChild(button6);
      }
    } else {
      if (moBtn) {
        moPlay = false;
        moBtn.remove();
      }
    }
  }

  // ã‹ãª->ãƒ­ãƒ¼ãƒå¤‰æ›
  function kanaToRoman(kana) {
    const romanMap = {
      'ã‚':['a'], 'ã„':['i', 'yi'], 'ã†':['u', 'wu'], 'ãˆ':['e'], 'ãŠ':['o'],
      'ã‹':['ka', 'ca'], 'ã':['ki'], 'ã':['ku', 'cu', 'qu'], 'ã‘':['ke'], 'ã“':['ko', 'co'],
      'ã•':['sa'], 'ã—':['si', 'shi', 'ci'], 'ã™':['su'], 'ã›':['se', 'ce'], 'ã':['so'],
      'ãŸ':['ta'], 'ã¡':['ti', 'chi'], 'ã¤':['tu', 'tsu'], 'ã¦':['te'], 'ã¨':['to'],
      'ãª':['na'], 'ã«':['ni'], 'ã¬':['nu'], 'ã­':['ne'], 'ã®':['no'],
      'ã¯':['ha'], 'ã²':['hi'], 'ãµ':['fu', 'hu'], 'ã¸':['he'], 'ã»':['ho'],
      'ã¾':['ma'], 'ã¿':['mi'], 'ã‚€':['mu'], 'ã‚':['me'], 'ã‚‚':['mo'],
      'ã‚„':['ya'], 'ã‚†':['yu'], 'ã‚ˆ':['yo'],
      'ã‚‰':['ra'], 'ã‚Š':['ri'], 'ã‚‹':['ru'], 'ã‚Œ':['re'], 'ã‚':['ro'],
      'ã‚':['wa'], 'ã‚':['wyi'], 'ã‚‘':['wye'], 'ã‚’':['wo'], 'ã‚“':['nn', 'xn', 'n'],
      'ãŒ':['ga'], 'ã':['gi'], 'ã':['gu'], 'ã’':['ge'], 'ã”':['go'],
      'ã–':['za'], 'ã˜':['ji', 'zi'], 'ãš':['zu'], 'ãœ':['ze'], 'ã':['zo'],
      'ã ':['da'], 'ã¢':['di'], 'ã¥':['du'], 'ã§':['de'], 'ã©':['do'],
      'ã°':['ba'], 'ã³':['bi'], 'ã¶':['bu'], 'ã¹':['be'], 'ã¼':['bo'],
      'ã±':['pa'], 'ã´':['pi'], 'ã·':['pu'], 'ãº':['pe'], 'ã½':['po'],
      'ã†ã':['wha'], 'ã†ãƒ':['whi'], 'ã†ã‡':['whe'], 'ã†ã‰':['who'],
      'ãã‚ƒ':['kya'], 'ããƒ':['kyi'], 'ãã‚…':['kyu'], 'ãã‡':['kye'], 'ãã‚‡':['kyo'],
      'ãã':['qa', 'qwa'], 'ããƒ':['qi', 'qwi'], 'ãã‡':['qe', 'qwe'], 'ãã‰':['qo', 'qwo'], 'ãã‚ƒ':['qya'], 'ãã‚…':['qyu'], 'ãã‚‡':['qyo'],
      'ã—ã‚ƒ':['sya', 'sha'], 'ã—ãƒ':['syi'], 'ã—ã‚…':['syu', 'shu'], 'ã—ã‡':['sye', 'she'], 'ã—ã‚‡':['syo', 'sho'],
      'ã¤ã':['tsa'], 'ã¤ãƒ':['tsi'], 'ã¤ã‡':['tse'], 'ã¤ã‰':['tso'],
      'ã¡ã‚ƒ':['tya', 'cha'], 'ã¡ãƒ':['tyi'], 'ã¡ã‚…':['tyu', 'chu'], 'ã¡ã‡':['tye', 'che'], 'ã¡ã‚‡':['tyo', 'cho'],
      'ã¦ã‚ƒ':['tha'], 'ã¦ãƒ':['thi'], 'ã¦ã‚…':['thu'], 'ã¦ã‡':['the'], 'ã¦ã‚‡':['tho'],
      'ã¨ã':['twa'], 'ã¨ãƒ':['twi'], 'ã¨ã…':['twu'], 'ã¨ã‡':['twe'], 'ã¨ã‰':['two'],
      'ã²ã‚ƒ':['hya'], 'ã²ãƒ':['hyi'], 'ã²ã‚…':['hyu'], 'ã²ã‡':['hye'], 'ã²ã‚‡':['hyo'],
      'ãµã':['fa'], 'ãµãƒ':['fi'], 'ãµã‡':['fe'], 'ãµã‰':['fo'],
      'ã«ã‚ƒ':['nya'], 'ã«ãƒ':['nyi'], 'ã«ã‚…':['nyu'], 'ã«ã‡':['nye'], 'ã«ã‚‡':['nyo'],
      'ã¿ã‚ƒ':['mya'], 'ã¿ãƒ':['myi'], 'ã¿ã‚…':['myu'], 'ã¿ã‡':['mye'], 'ã¿ã‚‡':['myo'],
      'ã‚Šã‚ƒ':['rya'], 'ã‚Šãƒ':['ryi'], 'ã‚Šã‚…':['ryu'], 'ã‚Šã‡':['rye'], 'ã‚Šã‚‡':['ryo'],
      'ãƒ´ã':['va'], 'ãƒ´ãƒ':['vi'], 'ãƒ´':['vu'], 'ãƒ´ã‡':['ve'], 'ãƒ´ã‰':['vo'],
      'ãã‚ƒ':['gya'], 'ããƒ':['gyi'], 'ãã‚…':['gyu'], 'ãã‡':['gye'], 'ãã‚‡':['gyo'],
      'ãã':['gwa'], 'ããƒ':['gwi'], 'ãã…':['gwu'], 'ãã‡':['gwe'], 'ãã‰':['gwo'],
      'ã˜ã‚ƒ':['ja', 'zya'], 'ã˜ãƒ':['jyi', 'zyi'], 'ã˜ã‚…':['ju', 'zyu'], 'ã˜ã‡':['je', 'zye'], 'ã˜ã‚‡':['jo', 'zyo'],
      'ã§ã‚ƒ':['dha'], 'ã§ãƒ':['dhi'], 'ã§ã‚…':['dhu'], 'ã§ã‡':['dhe'], 'ã§ã‚‡':['dho'],
      'ã¢ã‚ƒ':['dya'], 'ã¢ãƒ':['dyi'], 'ã¢ã‚…':['dyu'], 'ã¢ã‡':['dye'], 'ã¢ã‚‡':['dyo'],
      'ã³ã‚ƒ':['bya'], 'ã³ãƒ':['byi'], 'ã³ã‚…':['byu'], 'ã³ã‡':['bye'], 'ã³ã‚‡':['byo'],
      'ã´ã‚ƒ':['pya'], 'ã´ãƒ':['pyi'], 'ã´ã‚…':['pyu'], 'ã´ã‡':['pye'], 'ã´ã‚‡':['pyo'],
      'ã':['la', 'xa'], 'ãƒ':['li', 'xi'], 'ã…':['lu', 'xu'], 'ã‡':['le', 'xe'], 'ã‰':['lo', 'xo'],
      'ã‚ƒ':['lya', 'xya'], 'ã‚…':['lyu', 'xyu'], 'ã‚‡':['lyo', 'xyo'], 'ã£':['ltu', 'xtu'],
      'ãƒ¼':['-'], ',':[','], '.':['.'], 'ã€':[','], 'ã€‚':['.'],
      'ãƒ»':['/'], 'ã€':[','], 'ã€‚':['.'], 'ãƒ»':['/']
    };

    let remStr = String(kana), slStr, roman, next;
    let result = [];

    function splice() {
      let oneChar = remStr.slice(0, 1);
      remStr = remStr.slice(1);
      return oneChar;
    }

    function isSmallChar() {
      return !!remStr.slice(0, 1).match(/^[ããƒã…ã‡ã‰ã‚ƒã‚…ã‚‡]$/);
    }

    while (remStr) {
      slStr = splice();
      next = romanMap[remStr.slice(0, 1)];
      if (slStr == 'ã£') {
        if (!remStr || remStr.match(/^[,.]/) || !next || next[0].match(/^[aiueon]/)) {
          roman = [...romanMap[slStr]];
          result.push(roman);
        } else {
          slStr = splice();
          if (isSmallChar()) slStr += splice();
          roman = [...romanMap[slStr].map(str => str.slice(0, 1) + str)];
          result.push(roman);
        }
      } else {
        if (isSmallChar()) slStr += splice();
        if (slStr == '&') {
          slStr += remStr.slice(0, 7);
          remStr = remStr.slice(7);
        }
        roman = romanMap[slStr] ? [...romanMap[slStr]] : [...slStr];
        if (slStr == 'ã‚“') {
          if (!remStr) {
            roman.pop();
          } else {
            if (next[0].match(/^[aiueony]/)) roman.pop();
          }
        }
        result.push(roman);
      }
    }

    return result;
  }

  // æ‰“ã£ãŸéƒ¨åˆ†ã®è‰²ä»˜ã‘
  function colorTyped() {
    let html = '<div><span class="typed">';
    if (idx1 > 0) {
      for (let i = 0; i < idx1; i++) {
        html += wordR[i][pattern[i]];
      }
    }
    for (let i = 0; i <= idx2; i++) {
      html += wordR[idx1][pattern[idx1]][i];
    }
    html += '</span><span>';
    for (let i = idx2 + 1; i < wordR[idx1][pattern[idx1]].length; i++) {
      html += wordR[idx1][pattern[idx1]][i];
    }
    for (let i = idx1 + 1; i < wordR.length; i++) {
      html += wordR[i][pattern[i]];
    }
    html += '</span></div>';
    return html;
  }

  // ãƒ†ã‚­ã‚¹ãƒˆç§»å‹•å‡¦ç†
  function textMove() {
    const textS = document.querySelector('#sentence > div');
    const textE = document.querySelector('#example > div');
    const textK = document.querySelector('#kana > div');
    const textS1 = textS.querySelector('.typed');
    const textS2 = textS.querySelector('span:not(.typed)');
    let remLen = textS2.innerText.length;
    if (idx1 == 0) {
      over1 = textS.clientWidth - 580;
      over2 = textE.clientWidth - 580;
      over3 = textK.clientWidth - 580;
      left1 = 0, left2 = 0, left3 = 0;
    }
    if (textS.clientWidth > 580) {
      if (textS1.getBoundingClientRect().width > 310) {
        let move1 = textS2.getBoundingClientRect().width / remLen;
        left1 += move1;
        textS.style.left = -left1 + 'px';
      }
    }
    if (textE.clientWidth > 580) {
      let move2 = over2 / remLen;
      left2 += move2;
      textE.style.left = -left2 + 'px';
      over2 -= move2;
    }
    if (textK.clientWidth > 580) {
      let move3 = over3 / remLen;
      left3 += move3;
      textK.style.left = -left3 + 'px';
      over3 -= move3;
    }
  }

  // ãƒŸã‚¹å…¥åŠ›å‡¦ç†
  function missed() {
    miss++;
    if (recordM.indexOf(ridx[count - 1]) == -1) {
      recordM.push(ridx[count - 1]);
    }
    mScreen.classList.add('missed');
    setTimeout(() => {
      mScreen.classList.remove('missed');
    }, 200);
  }

  // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚­ãƒ¼å‡¦ç†
  function selActive() {
    const prevActive = keyboard.querySelector('.active');
    const selector = '.key_' + keyConvert(wordR[idx1][pattern[idx1]][idx2]);
    const target = keyboard.querySelector(selector);
    if (prevActive) {
      prevActive.classList.remove('active');
    }
    if (target && flagG) {
      target.classList.add('active');
    }
  }

  // å¯¾å¿œã‚­ãƒ¼ã®å¤‰æ›
  function keyConvert(key) {
    const keyMap = {
      '-':'hyphen', '@':'atmark', ';':'semicolon', ':':'colon', ',':'comma',
      '.':'period', '/':'slash', ' ':'space'
    }

    if (keyMap[key]) {
      return keyMap[key];
    } else {
      return key;
    }
  }

  // ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãƒ¬ãƒ™ãƒ«åˆ¤å®š
  function getLevel(score) {
    let level;
    if (score == '-') {
      level = '-';
    } else {
      switch (true) {
        case 0 <= score && score <= 21:
          level = 'E-';
          break;
        case 21 < score && score <= 38:
          level = 'E';
          break;
        case 38 < score && score <= 55:
          level = 'E+';
          break;
        case 55 < score && score <= 72:
          level = 'D-';
          break;
        case 72 < score && score <= 89:
          level = 'D';
          break;
        case 89 < score && score <= 106:
          level = 'D+';
          break;
        case 106 < score && score <= 123:
          level = 'C-';
          break;
        case 123 < score && score <= 140:
          level = 'C';
          break;
        case 140 < score && score <= 157:
          level = 'C+';
          break;
        case 157 < score && score <= 174:
          level = 'B-';
          break;
        case 174 < score && score <= 191:
          level = 'B';
          break;
        case 191 < score && score <= 208:
          level = 'B+';
          break;
        case 208 < score && score <= 225:
          level = 'A-';
          break;
        case 225 < score && score <= 242:
          level = 'A';
          break;
        case 242 < score && score <= 259:
          level = 'A+';
          break;
        case 259 < score && score <= 276:
          level = 'S';
          break;
        case 276 < score && score <= 299:
          level = 'Good!';
          break;
        case 299 < score && score <= 324:
          level = 'Fast';
          break;
        case 324 < score && score <= 349:
          level = 'Thunder';
          break;
        case 349 < score && score <= 374:
          level = 'Ninja';
          break;
        case 374 < score && score <= 399:
          level = 'Comet';
          break;
        case 399 < score && score <= 449:
          level = 'Professor';
          break;
        case 449 < score && score <= 499:
          level = 'LaserBeam';
          break;
        case 499 < score && score <= 549:
          level = 'EddieVH';
          break;
        case 549 < score && score <= 599:
          level = 'Meijin';
          break;
        case 599 < score && score <= 649:
          level = 'Rocket';
          break;
        case 649 < score && score <= 699:
          level = 'Tatsujin';
          break;
        case 699 < score && score <= 749:
          level = 'Jedi';
          break;
        case 749 < score && score <= 799:
          level = 'Godhand';
          break;
        case 799 < score:
          level = 'Joker';
          break;
      }
    }
    return level;
  }

  // è‹¦æ‰‹ã‚­ãƒ¼ä¸Šä½5å€‹ã‚’å–å¾—
  function getWeaks(keys) {
    let keyData1 = {};
    keys.forEach((key) => {
      if (keyData1[key] != undefined) {
        keyData1[key] += 1;
      } else {
        keyData1[key] = 1;
      }
    });
    let keyData2 = Object.keys(keyData1).map(k => ({key:k, miss:keyData1[k]}));
    keyData2.sort((a, b) => b.miss - a.miss);

    let res = '';
    let max = (keyData2.length < 5) ? keyData2.length : 5;
    for (let i = 0; i < max; i++) {
      if (i != max - 1) {
        res += keyData2[i].key + ' ';
      } else {
        res += keyData2[i].key;
      }
    }
    return res;
  }

  // å…¥åŠ›æ™‚é–“ã®å¤‰æ›
  function convTime(time) {
    let m, ms, s, res;
    if (time >= 60000) {
      m = Math.floor(time / 60000);
      ms = time - m * 60000;
      s = (ms / 1000).toFixed(2);
      res = m + 'åˆ†' + s.slice(0, -3) + 'ç§’' + s.slice(-2);
    } else {
      s = (time / 1000).toFixed(2);
      res = s.slice(0, -3) + 'ç§’' + s.slice(-2);
    }
    return res;
  }

  // æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›
  function convStr(str) {
    let res;
    if (str == 'NaN') {
      res = '0';
    } else {
      if (str.slice(-2) == '00') {
        res = str.slice(0, -3);
      } else {
        res = str;
      }
    }
    return res;
  }

  // ã‚¹ã‚¤ãƒƒãƒå‡¦ç†
  function toggle(idx, flag) {
    if (flag) {
      onBtns[idx].click();
    } else {
      offBtns[idx].click();
    }
  }

  // ãƒªãƒ—ãƒ¬ã‚¤å‡¦ç†
  function replay() {
    moPlay = false;
    result.style.display = 'none';
    view2.style.display = 'block';
    startMsg.style.display = 'block';

    sWait = true;
    space.classList.add('active');
  }

  // ã‚¯ãƒ­ãƒ¼ã‚ºå‡¦ç†
  function close() {
    isOpen = false;
    startFlag = false;
    playing = false;
    nFlag = false;
    missFlag = false;
    moPlay = false;
    gameData = [];

    const active = keyboard.querySelector('.active');
    if (active) active.classList.remove('active');

    view2.style.display = 'none';
    result.style.display = 'none';
    example.innerHTML = '';
    kana.innerHTML = '';
    sentence.innerHTML = '';
    progress.style.transform = 'none';
    overlay.style.display = 'none';
    game.style.display = 'none';
  }

  // ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚
  button1.addEventListener('click', close);
  button2.addEventListener('click', open);
  button3.addEventListener('click', start);
  button4.addEventListener('click', replay);
  button5.addEventListener('click', close);
  for (let i = 0; i < onBtns.length; i++) {
    onBtns[i].addEventListener('click', () => {
      onBtns[i].classList.remove('show');
      offBtns[i].classList.add('show');
      flags[i] = false;
    });
  }
  for (let i = 0; i < offBtns.length; i++) {
    offBtns[i].addEventListener('click', () => {
      offBtns[i].classList.remove('show');
      onBtns[i].classList.add('show');
      flags[i] = true;
    });
  }

  // ã‚­ãƒ¼æŠ¼ä¸‹æ™‚
  window.addEventListener('keydown', (event) => {
    let key = event.key;
    if (isOpen && !startFlag) {
      if (key == ' ') event.preventDefault();
      if (key == 'r') toggle(0, flags[0]);
      if (key == 'k') toggle(1, flags[1]);
      if (key == 'g') toggle(2, flags[2]);
      if (key == 'w') toggle(3, flags[3]);
      if (key == 's') toggle(4, flags[4]);
    }
    if (startFlag) { // ã‚²ãƒ¼ãƒ é–‹å§‹
      if (key == ' ') event.preventDefault();
      if (sWait) { // ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼å…¥åŠ›å¾…ã¡ã®å ´åˆ
        if (key == ' ') {
          sWait = false;
          space.classList.remove('active');
          ready();
        }
      }
      if (playing) { // ãƒ—ãƒ¬ã‚¤ä¸­
        if (key == 'Escape') { // Escã‚’æŠ¼ã—ãŸå ´åˆ
          isStopped = true;
          finish();
        } else {
          temp += key;
          if (key == wordR[idx1][pattern[idx1]][idx2]) {
            sentence.innerHTML = colorTyped();
            if (missFlag) {
              recordHTML += '<span class="miss">' + key + '</span>';
              weakKeys.push(key);
              missFlag = false;
            } else {
              recordHTML += key;
            }
            textMove();
            correct++;
            idx2++;
          } else {
            let reg = new RegExp('^' + temp);
            for (let i = 0; i < wordR[idx1].length; i++) {
              if (!!wordR[idx1][i].match(reg)) {
                pattern[idx1] = i;
                break;
              }
            }
            if (key == wordR[idx1][pattern[idx1]][idx2]) {
              sentence.innerHTML = colorTyped();
              if (missFlag) {
                recordHTML += '<span class="miss">' + key + '</span>';
                weakKeys.push(key);
                missFlag = false;
              } else {
                recordHTML += key;
              }
              textMove();
              correct++;
              idx2++;
            } else {
              if (wordR[idx1][pattern[idx1]] == 'nn' && wordR[idx1].length == 3) { // ã€Œã‚“ã€ã®ç‰¹åˆ¥æªç½®
                for (let i = 0; i < wordR[idx1 + 1].length; i++) {
                  if (key == wordR[idx1 + 1][i][0]) {
                    pattern[idx1] = 2;
                    pattern[idx1 + 1] = i;
                    nFlag = true;
                    correct++;
                    break;
                  }
                }
                if (!nFlag) {
                  missFlag = true;
                  temp = temp.slice(0, -1);
                  missed();
                }
              } else {
                missFlag = true;
                temp = temp.slice(0, -1);
                missed();
              }
            }
          }
          if (idx2 == wordR[idx1][pattern[idx1]].length) {
            idx1++;
            if (nFlag) {
              idx2 = 0;
              sentence.innerHTML = colorTyped();
              textMove();
              if (missFlag) {
                recordHTML += '<span class="miss">' + key + '</span>';
                weakKeys.push(key);
                missFlag = false;
              } else {
                recordHTML += key;
              }
              idx2 = 1;
              nFlag = false;
              temp = temp.slice(1);
            } else {
              idx2 = 0;
              temp = '';
            }
          }
          if (idx1 == wordR.length) {
            record.push(recordHTML);
            recordHTML = '';
            idx1 = 0;
            wordSet();
          } else {
            if (!missFlag) selActive();
          }
        }
      }
    }
  });

  // ãƒªã‚µã‚¤ã‚ºæ™‚
  window.addEventListener('resize', () => {
    if (isOpen) {
      overlay.style.width = document.body.clientWidth + 'px';
      overlay.style.height = document.body.clientHeight + 'px';
      game.style.top = window.pageYOffset + window.innerHeight / 2 - game.clientHeight / 2 + 'px';
      game.style.left = window.innerWidth / 2 - game.clientWidth / 2 + 'px';
    }
  });
})(window, document);
</script>
<style>
#typing-start {
  font-family: Meiryo, Arial, sans-serif;
  text-align: center;
  padding: 20px 6px 5px;
  background-color: #fff2d8;
  border: 1px solid #ffd687;
  border-radius: 3px;
}
#typing-start p {
  font-size: 15px;
  margin: 0 0 15px;
}
#typing-start p + p {
  margin: 0;
}
#typing-start .note {
  font-size: 14px;
}
#typing-start .msg {
  color: tomato;
}
#open-button {
  display: block;
  width: 308px;
  height: 48px;
  font-size: 17px;
  font-weight: bold;
  color: #fff;
  background: linear-gradient(0deg, #ffb500, #ffcf00);
  border: 0;
  border-radius: 3em;
  margin: 20px auto 30px;
  box-shadow: 0 1px 1px rgba(0,0,0,.2);
  overflow: hidden;
  cursor: pointer;
  appearance: none;
}
#game-overlay {
  position: absolute;
  top: 0;
  left: 0;
  background: #000;
  opacity: .8;
  z-index: 9999;
}
#game-screen {
  display: none;
  position: absolute;
  width: 748px;
  background: #fff;
  padding: 0 10px 10px;
  z-index: 10000;
}
#game-screen, #game-screen * {
  font-family: Meiryo, Arial, sans-serif;
  box-sizing: border-box;
}
#game-screen ul {
  list-style-type: none;
  padding: 0;
  margin: 0;
}
#game-header {
  position: relative;
  height: 40px;
  border-bottom: 1px solid #cacaca;
  margin: 0 0 5px;
}
#close-button1 {
  position: absolute;
  top: 6px;
  right: 0;
  width: 63px;
  height: 27px;
  font-size: 11px;
  font-weight: bold;
  color: #777;
  background: linear-gradient(0deg, #eee, #fff);
  padding: 1px 5px;
  border: 1px solid #ccc;
  border-radius: 3px;
  cursor: pointer;
  appearance: none;
}
#close-button1:before {
  content: "";
  display: inline-block;
  width: 12px;
  height: 12px;
  background-image: url('data:image/svg+xml;utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z" fill="%23777"/></svg>');
  background-size: contain;
  background-repeat: no-repeat;
  margin-right: 2px;
  vertical-align: -0.2em;
}
#close-button1:hover {
  background: linear-gradient(180deg, #eee, #fff);
}
#game-header .description {
  height: 40px;
  font-size: 18px;
  color: #7b7a7a;
  line-height: 40px;
  margin: 0 0 0 5px;
}
#game-banner {
  width: 728px;
  height: 90px;
  margin: 0 auto 5px;
}
#game-banner a {
  display: block;
  width: 100%;
  height: 100%;
}
#game-body {
  display: table;
  width: 728px;
  height: 470px;
  color: #636363;
}
#game-view1 {
  position: relative;
  display: table-cell;
  text-align: center;
  vertical-align: middle;
}
#game-title {
  font-size: 24px;
}
#game-explain {
  font-size: 15px;
  padding: 0 24px;
  margin: 12px 0 74px;
}
#start-button {
  width: 160px;
  height: 45px;
  line-height: 45px;
  text-align: center;
  color: #fff;
  font-size: 14px;
  font-weight: bold;
  background: #057fff;
  border: 0;
  border-radius: 3px;
  margin: 0 auto;
  cursor: pointer;
  appearance: none;
}
#game-func {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  height: 28px;
  line-height: 26px;
  background-color: #f3f3f3;
  padding: 0 12px;
  border-radius: 3px;
  border: 1px solid #d9d9d9;
  white-space: nowrap;
}
#game-func > span {
  display: inline-block;
  font-size: 11px;
}
#game-func .switch-btn {
  display: inline-block;
  position: relative;
  width: 36px;
  height: 16px;
  vertical-align: middle;
  margin-right: 6px;
  overflow: hidden;
}
#game-func .switch-btn:last-child {
  margin-right: 0;
}
#game-func .switch-btn .btn {
  position: absolute;
  display: none;
  top: 0;
  left: 0;
  width: 36px;
  height: 16px;
  line-height: 15px;
  letter-spacing: 0.5px;
  font-size: 11px;
  color: #fff;
  text-align: center;
  border: 0;
  border-radius: 3px;
  overflow: hidden;
  cursor: pointer;
  appearance: none;
}
#game-func .switch-btn .on-btn {
  background-color: #2a89ff;
}
#game-func .switch-btn .off-btn {
  background-color: #ff4032;
}
.show {
  display: block !important;
}
#game-view2 {
  display: none;
}
#text-container {
  position: relative;
  max-width: 610px;
  height: 172px;
  border: 1px solid #d8d8d8;
  margin: 0 auto 10px;
  overflow: hidden;
}
#miss-type-screen {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(255, 0, 0, 0.2);
  opacity: 0;
}
#miss-type-screen.missed {
  animation: miss .2s;
}
#start-msg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  font-size: 14px;
  text-align: center;
  line-height: 170%;
  padding-top: 46px;
}
#start-msg p {
  padding: 0;
  margin: 0 0 4px;
}
#start-msg em {
  font-size: 24px;
  font-style: normal;
  color: #ff9c00;
}
#countdown {
  position: absolute;
  top: 50%;
  left: 50%;
  color: #ff9c00;
  font-size: 80px;
  transform: translateX(-50%) translateY(-50%);
}
#example {
  position: absolute;
  left: 15px;
  top: 36px;
  width: 580px;
  height: 36px;
  font-size: 30px;
  line-height: 36px;
  overflow: hidden;
  font-variant-ligatures: no-common-ligatures;
}
#example > div {
  position: absolute;
  top: 0;
  left: 0;
  height: 30px;
  white-space: nowrap;
}
#kana {
  position: absolute;
  left: 15px;
  top: 73px;
  width: 580px;
  height: 24px;
  font-size: 20px;
  line-height: 24px;
  overflow: hidden;
  font-variant-ligatures: no-common-ligatures;
}
#kana > div {
  position: absolute;
  top: 0;
  left: 0;
  height: 20px;
  white-space: nowrap;
}
#sentence {
  position: absolute;
  left: 15px;
  top: 102px;
  width: 580px;
  height: 30px;
  font-size: 26px;
  line-height: 26px;
  overflow: hidden;
  text-transform: uppercase;
  font-variant-ligatures: no-common-ligatures;
}
#sentence > div {
  position: absolute;
  top: 0;
  left: 0;
  height: 30px;
  white-space: nowrap;
}
#sentence .typed {
  color: #ffd0a6;
}
#progress-bar {
  position: absolute;
  bottom: 1px;
  left: 5px;
  width: calc(100% - 10px);
  height: 4px;
  background-color: #bcbcbc;
  transform-origin: left top;
}
#current-wpm {
  display: none;
  position: absolute;
  top: 5px;
  right: 10px;
}
#speed-bar {
  display: none;
  position: absolute;
  top: 2px;
  left: 5px;
  width: calc(100% - 10px);
  height: 3px;
  background: linear-gradient(90deg, #87cefa, #ff6347);
  transform-origin: left top;
}
.cover {
  top: 0;
  right: 0;
  height: 3px;
  background: #fff;
  transform-origin: right top;
}
#virtual-keyboard {
  position: relative;
  width: 610px;
  margin: 0 auto;
}
#virtual-keyboard div {
  position: absolute;
  width: 36px;
  height: 36px;
  border: 1px solid #d8d8d8;
  border-radius: 3px;
  font-weight: bold;
  font-size: 16px;
  line-height: 34px;
  text-align: center;
  overflow: hidden;
}
#virtual-keyboard div.key_1 {
  top: 0;
  left: 41px;
}
#virtual-keyboard div.key_2 {
  top: 0;
  left: 82px;
}
#virtual-keyboard div.key_3 {
  top: 0;
  left: 123px;
}
#virtual-keyboard div.key_4 {
  top: 0;
  left: 164px;
}
#virtual-keyboard div.key_5 {
  top: 0;
  left: 205px;
}
#virtual-keyboard div.key_6 {
  top: 0;
  left: 246px;
}
#virtual-keyboard div.key_7 {
  top: 0;
  left: 287px;
}
#virtual-keyboard div.key_8 {
  top: 0;
  left: 328px;
}
#virtual-keyboard div.key_9 {
  top: 0;
  left: 369px;
}
#virtual-keyboard div.key_0 {
  top: 0;
  left: 410px;
}
#virtual-keyboard div.key_hyphen {
  top: 0;
  left: 451px;
}
#virtual-keyboard div.deco_key2 {
  top: 0;
  left: 492px;
}
#virtual-keyboard div.deco_key3 {
  top: 0;
  left: 533px;
}
#virtual-keyboard div.deco_key4 {
  top: 0;
  left: 574px;
}
#virtual-keyboard div.deco_key5 {
  top: 41px;
  width: 56px;
}
#virtual-keyboard div.key_q {
  top: 41px;
  left: 61px;
}
#virtual-keyboard div.key_w {
  top: 41px;
  left: 102px;
}
#virtual-keyboard div.key_e {
  top: 41px;
  left: 143px;
}
#virtual-keyboard div.key_r {
  top: 41px;
  left: 184px;
}
#virtual-keyboard div.key_t {
  top: 41px;
  left: 225px;
}
#virtual-keyboard div.key_y {
  top: 41px;
  left: 266px;
}
#virtual-keyboard div.key_u {
  top: 41px;
  left: 307px;
}
#virtual-keyboard div.key_i {
  top: 41px;
  left: 348px;
}
#virtual-keyboard div.key_o {
  top: 41px;
  left: 389px;
}
#virtual-keyboard div.key_p {
  top: 41px;
  left: 430px;
}
#virtual-keyboard div.key_atmark {
  top: 41px;
  left: 471px;
}
#virtual-keyboard div.deco_key6 {
  top: 41px;
  left: 512px;
}
#virtual-keyboard div.key_Enter {
  top: 41px;
  left: 553px;
  width: 57px;
  height: 77px;
  clip-path: polygon(0 0, 100% 0, 100% 100%, 21px 100%, 21px 36px, 0 36px);
}
#virtual-keyboard div.key_Enter:after {
  position: absolute;
  display: block;
  content: "";
  top: 34px;
  left: 0;
  width: 20px;
  height: 41px;
  border-top: 1px solid #d8d8d8;
  border-right: 1px solid #d8d8d8;
}
#virtual-keyboard div.deco_key7 {
  top: 82px;
  width: 76px;
}
#virtual-keyboard div.key_a {
  top: 82px;
  left: 81px;
}
#virtual-keyboard div.key_s {
  top: 82px;
  left: 122px;
}
#virtual-keyboard div.key_d {
  top: 82px;
  left: 163px;
}
#virtual-keyboard div.key_f {
  top: 82px;
  left: 204px;
}
#virtual-keyboard div.key_g {
  top: 82px;
  left: 245px;
}
#virtual-keyboard div.key_h {
  top: 82px;
  left: 286px;
}
#virtual-keyboard div.key_j {
  top: 82px;
  left: 327px;
}
#virtual-keyboard div.key_k {
  top: 82px;
  left: 368px;
}
#virtual-keyboard div.key_l {
  top: 82px;
  left: 409px;
}
#virtual-keyboard div.key_semicolon {
  top: 82px;
  left: 450px;
}
#virtual-keyboard div.key_colon {
  top: 82px;
  left: 491px;
}
#virtual-keyboard div.deco_key8 {
  top: 82px;
  left: 532px;
}
#virtual-keyboard div.key_lShift {
  top: 123px;
  left: 0;
  width: 96px;
}
#virtual-keyboard div.key_z {
  top: 123px;
  left: 101px;
}
#virtual-keyboard div.key_x {
  top: 123px;
  left: 142px;
}
#virtual-keyboard div.key_c {
  top: 123px;
  left: 183px;
}
#virtual-keyboard div.key_v {
  top: 123px;
  left: 224px;
}
#virtual-keyboard div.key_b {
  top: 123px;
  left: 265px;
}
#virtual-keyboard div.key_n {
  top: 123px;
  left: 306px;
}
#virtual-keyboard div.key_m {
  top: 123px;
  left: 347px;
}
#virtual-keyboard div.key_comma {
  top: 123px;
  left: 388px;
}
#virtual-keyboard div.key_period {
  top: 123px;
  left: 429px;
}
#virtual-keyboard div.key_slash {
  top: 123px;
  left: 470px;
}
#virtual-keyboard div.deco_key9 {
  top: 123px;
  left: 511px;
}
#virtual-keyboard div.key_rShift {
  top: 123px;
  left: 552px;
  width: 58px;
}
#virtual-keyboard div.deco_key10 {
  top: 164px;
  left: 0;
  width: 56px;
}
#virtual-keyboard div.deco_key11 {
  top: 164px;
  left: 61px;
}
#virtual-keyboard div.deco_key12 {
  top: 164px;
  left: 102px;
}
#virtual-keyboard div.deco_key13 {
  top: 164px;
  left: 143px;
}
#virtual-keyboard div.key_space {
  top: 164px;
  left: 184px;
  width: 181px;
}
#virtual-keyboard div.deco_key14 {
  top: 164px;
  left: 370px;
}
#virtual-keyboard div.deco_key15 {
  top: 164px;
  left: 411px;
}
#virtual-keyboard div.deco_key16 {
  top: 164px;
  left: 452px;
  width: 56px;
}
#virtual-keyboard div.deco_key17 {
  top: 164px;
  left: 513px;
}
#virtual-keyboard div.deco_key18 {
  top: 164px;
  left: 554px;
  width: 56px;
}
#virtual-keyboard div.active {
  background-color: #ff9c00 !important;
  border-color: #ff9c00 !important;
  color: #fff !important;
}
#game-result {
  display: none;
  width: 728px;
}
#current-result {
  position: relative;
  float: left;
  width: 590px;
  height: 337px;
  border: 1px solid #d0d0d0;
  margin: 0 0 12px;
}
#game-result .result-title {
  height: 37px;
  font-size: 15px;
  font-weight: bold;
  line-height: 37px;
  overflow: hidden;
  margin: 0;
  padding: 0 0 0 10px;
}
#current-result .result-title {
  color: #027fff;
  border-bottom: 1px solid #d0d0d0;
}
#example-list {
  position: absolute;
  top: 49px;
  left: 12px;
  width: 376px;
  height: 274px;
  padding: 10px;
  overflow: auto;
  border: 1px solid #d0d0d0;
}
#example-list ul {
  width: 354px;
}
#example-list ul li {
  font-size: 16px;
  margin-bottom: 12px;
  overflow-wrap: break-word;
}
#example-list .sentence {
  text-transform: uppercase;
}
#example-list .miss {
  color: #f00;
}
#game-result .result-data {
  position: absolute;
  width: 188px;
  height: 298px;
  top: 37px;
  right: 0;
  padding: 12px 11px 0 11px;
  background: #f7f7f7;
}
#game-result .result-data ul li {
  position: relative;
  border-bottom: 1px solid #d0d0d0;
}
#game-result .result-data ul li .title {
  position: absolute;
  font-size: 11px;
  height: 32px;
  line-height: 32px;
  top: 0;
  left: 0;
}
#game-result .result-data ul li .data {
  color: #027fff;
  font-size: 14px;
  height: 32px;
  line-height: 32px;
  width: 166px;
  text-align: right;
  font-weight: bold;
  padding-right: 6px;
}
#game-result .result-data ul li:last-child .data {
  text-transform: uppercase;
}
#prev-result {
  position: relative;
  width: 138px;
  height: 337px;
  float: right;
  border-top: 1px solid #d0d0d0;
  border-right: 1px solid #d0d0d0;
  border-bottom: 1px solid #d0d0d0;
}
#prev-result .result-title {
  border-bottom: 1px solid #d0d0d0;
}
#prev-result .result-data {
  width: 137px;
}
#prev-result .result-data ul li .data {
  width: 115px;
}
#result-comment {
  position: relative;
  width: 728px;
  height: 53px;
  text-align: center;
  border: 1px solid #d0d0d0;
  margin: 12px 0 0;
  clear: both;
}
#result-comment .container {
  position: absolute;
  width: 726px;
  font-size: 14px;
  top: 50%;
  left: 0;
  transform: translateY(-50%);
  padding: 0 18px;
}
#btn-area {
  position: relative;
  margin: 18px 0 0;
}
#game-result .btn {
  position: absolute;
  display: block;
  width: 129px;
  height: 39px;
  color: #fff;
  font-size: 14px;
  text-align: center;
  line-height: 39px;
  overflow: hidden;
  border-radius: 3px;
  cursor: pointer;
  border: 0;
  appearance: none;
}
#replay-button {
  top: 0;
  right: 289px;
  background-color: #027fff;
}
#close-button2 {
  top: 0;
  right: 0;
  color: #7b7a7a !important;
  background-color: #f4f5f5;
}
#miss-only-button {
  top: 0;
  left: 164px;
  background-color: #23c21f;
}
@keyframes miss {
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}
</style>
